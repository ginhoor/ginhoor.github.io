## CoreData存取JSON数据
  服务端提供的数据都是**JSON**格式的，客户端会有一个与之对应的**Model**来负责解析。CoreData存取数据又需要用到**NSManagedObject**，而**NSManagedObject**，CoreData又是推荐使用自动生成的。然后就出现了**Model**和**NSManagedObject**需要无法直接映射的问题。

  所以要解决的问题就是将**Model**的数据转换到**NSManagedObject**上，我采用的方法是创建一个delegate，delegate实现的是指定容器类型的实现类，同时也是指定**NSManagedObject**的关系实现类。

  然后创建一个方法，先遍历**NSManagedObject**的Entity，获取到它的PropertyList，然后先将非容器类型的值设置到**Model**中，再单独处理容器类型的值进行循环转换，最终将**NSManagedObject**转换成**Model**。



## 七牛无法批量上传图片

  数据要求一次性完整上传，用的是七牛的图床，SDK只支持单张的异步上传。

  需要满足中途可以取消，等待异步结果返回后才继续执行，有完成回调。

  我的方案用的是用NSBlockOperation。创建一个并发数为1的队列。

  根据上传图片的数量创建具体上传的Block，在最后一个Block后添加一个Block作为完成回调方法。每个Block都依赖于前一个Block执行。

  每个Block执行前，先挂起队列中的其他任务；再检测是否满足取消条件，如果满足取消条件，则取消队列中所有任务，并且添加一个Block作为完成回调。继续就执行Block中的上传，等待返回结果后，再恢复队列，进行下一个任务执行。

## 首页启动缓慢
  首先是定位耗时原因，判断是preload缓慢，main缓慢，还是tabBarControler加载缓慢。
  Time Profiler测试结果，主线程在加载时占用了大量的CPU资源，消耗了2.8秒的加载时间，其中2.5秒用于处理UI绘制。

  最终使用了AsyncDisplayKit的异步绘制方案来解决。

